<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="nogari.system.log.dao.mapper.ErrorLogMapper">
    <insert id="insertErrorLog" parameterType="nogari.system.log.domain.dto.ErrorLogDTO">
        INSERT INTO ERR_LOG (
               TRAN_DT
             , TRAN_SEQ
             , TRAN_TM
             , MENU_CD
             , REQ_PATH
             , SER_PATH
             , ERR_TYPE
             , ERR_CD
             , ERR_MSG
             , MEMBER_ID
             ) VALUES (
               TO_CHAR(CURRENT_DATE, 'YYYYMMDD')
             , SEQ_ERR_LOG.NEXTVAL
             , TO_CHAR(CURRENT_DATE, 'HH24MISS')
             , #{menuCd}
             , #{reqPath}
             , #{serPath}
             , #{errType}
             , #{errCd}
             , #{errMsg}
             , #{memberId}
             )
    </insert>

     <select id="selectLogList" parameterType="nogari.system.log.domain.dto.ErrorLogDTO" resultType="nogari.system.log.domain.dto.ErrorLogDTO">
      SELECT TRAN_DT
           , TRAN_SEQ
           , TRAN_TM
           , MENU_CD
           , REQ_PATH
           , SER_PATH
           , ERR_TYPE
           , ERR_CD
           , ERR_MSG
           , MEMBER_ID
        FROM ERR_LOG
       WHERE 1=1
         <if test='(tranDtFrom != "" and tranDtFrom !=null) and (tranDtTo !="" and tranDtTo !=null)' >
            /*오류발생일자*/
              AND TRAN_DT BETWEEN #{tranDtFrom} AND #{tranDtTo}
         </if>
         <if test='memberId != "" and memberId !=null' >
            /*사용자조회*/
              AND MEMBER_ID = #{memberId}
         </if>
     </select>
</mapper>